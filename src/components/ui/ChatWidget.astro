---
import { Image } from 'astro:assets';

import chatIcon from '../../assets/logos/IMGChatv2.webp';
---

<button 
    id="chat-trigger" 
    class="chat-trigger" 
    aria-label="Abrir asistente virtual"
>
    <Image 
        src={chatIcon} 
        alt="Chat Icon"
        class="chat-trigger__img"
        widths={[80, 120, 160]}
        sizes="80px"
        format="webp"
        quality={100}
        loading="eager"
        decoding="async"
    />
</button>

<div id="chat-window" class="chat-window">
    <div class="chat-window__header">
        <div class="chat-header__info">
            <div class="chat-header__status-dot"></div>
            <span class="chat-header__title">Asistente Jaguar</span>
        </div>
        <button id="chat-close-btn" class="chat-header__close" aria-label="Cerrar chat">&times;</button>
    </div>

    <div id="chat-messages" class="chat-window__messages">
    </div>

    <div id="typing-indicator" class="chat-window__typing">
        Jaguar est√° escribiendo<span class="dot-flashing"></span>
    </div>

    <div id="suggestions-container" class="chat-window__suggestions"></div>

    <div class="chat-window__input-area">
        <input type="text" id="chat-input" class="chat-input__field" placeholder="Escribe tu duda..." autocomplete="off">
        <button id="chat-send-btn" class="chat-input__send">Enviar</button>
    </div>
</div>

<script>
    import { initChatWidget } from '../../scripts/chatWidget.js';

    document.addEventListener('astro:page-load', () => {
        initChatWidget();
    });
</script>
