---
import { Image } from 'astro:assets';
import '../../styles/join/carruselAreas.css';

// OPTIMIZACIÓN PROFESIONAL: 
// 1. Cargamos todas las imágenes de la carpeta assets/Areas
// 2. Astro generará automáticamente los formatos WebP y los tamaños responsivos.
const areaImages = await Astro.glob('../../assets/Areas/*.{jpg,JPG,jpeg,JPEG,png,PNG,webp,WEBP}');

// Ordenamos las imágenes numéricamente si se llaman "1.webp", "2.webp", etc.
// (Opcional: Si el orden importa, asegúrate que los archivos estén nombrados 01.webp, 02.webp...)
areaImages.sort((a, b) => {
    const nameA = a.default.src.split('/').pop();
    const nameB = b.default.src.split('/').pop();
    return nameA.localeCompare(nameB, undefined, { numeric: true, sensitivity: 'base' });
});
---

<section class="areas-showcase">
    <h2 class="areas-showcase__title">Nuestras Áreas</h2>
    
    <div class="carousel-wrapper">
        <button class="areas-showcase__btn areas-showcase__btn--prev" id="btn-prev" aria-label="Ver área anterior">&#10094;</button>

        <div class="areas-carousel" id="carruselAreas">
            {areaImages.map((img, index) => (
                <div class="area-card">
                    {/* USO DE COMPONENTE IMAGE DE ASTRO:
                        - formats: webp (automático)
                        - widths: genera versiones pequeñas para móvil y grandes para PC
                        - loading: lazy (para que no frenen la carga inicial de la página)
                    */}
                    <Image 
                        src={img.default} 
                        alt={`Área Jaguar Racing ${index + 1}`} 
                        class="area-card__img"
                        width={640} 
                        height={360}
                        widths={[320, 640]} 
                        sizes="(max-width: 640px) 100vw, 640px"
                        loading="lazy" 
                        decoding="async"
                    />
                </div>
            ))}
        </div>

        <button class="areas-showcase__btn areas-showcase__btn--next" id="btn-next" aria-label="Ver siguiente área">&#10095;</button>
    </div>
    
    <div class="areas-showcase__indicators" id="indicadores"></div>
</section>

{/* Script diferido para no bloquear el renderizado */}
<script is:inline defer src="/js/carrusel.js"></script>